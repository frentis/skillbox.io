!function(a,i){function n(e){return"[object Array]"===Object.prototype.toString.call(e)}var o={},d={isInitialized:!1,apiUrl:null},r=function(e){for(var t=e+"=",r=i.cookie.split(";"),n=0;n<r.length;n++){for(var a=r[n];" "==a.charAt(0);)a=a.substring(1);if(0==a.indexOf(t))return a.substring(t.length,a.length)}return""},c=["msk.ru","com.br"],s=function(e,t){var r=new Date;r.setTime(r.getTime()+31536e7);var r="expires="+r.toUTCString();i.cookie=e+"="+t+";"+r+";domain="+(r=location.hostname,2<location.hostname.split(".").length&&(r=location.hostname.split(".").reverse().slice(0,2).reverse().join("."),~c.indexOf(r)&&(r=location.hostname.split(".").reverse().slice(0,3).reverse().join("."))),r)+";path=/"},p=function(){return(""+1e7+-1e3+-4e3+-8e3+-1e11).replace(/1|0/g,function(){return(0|16*Math.random()).toString(16)}).replace(/-/g,"")};function u(){if(d.customUserId)return e=function(e,t){for(var r=e;r.length<t;)r+="0";return r}(d.customUserId.replace(/\D/g,""),32);var e,t="iap.uid";return(e=r(t))&&32===e.length||(e=p(),s(t,e)),e}function l(e,t,r){t.push("uid="+u());var n,t=[d.apiUrl,e,"?",t.join("&")].join("");a.navigator.sendBeacon?(n=new Blob([JSON.stringify(r||{})],{type:"text/plain"}),a.navigator.sendBeacon(t,n)):((n=new XMLHttpRequest).open("POST",t,!0),n.setRequestHeader("Content-Type","application/json"),n.withCredentials=!0,r=JSON.stringify(r),n.send(r))}if(o.push=function(e){try{if(!n(e))throw new TypeError("iapSDK: Push item is not array");var t=e[0],r=e[1];if("function"!=typeof o[t]||"push"===t)throw new ReferenceError("iapSDK: Not found method "+t);o[t](r)}catch(e){console.error(e.message)}},o.init=function(e){if(!(e=e||{}).apiUrl)throw new TypeError("iapSDK: Init must set api url");if(d.isInitialized)throw new Error("iapSDK: SDK already init");d.isInitialized=!0,d.apiUrl=e.apiUrl,d.customUserId=e.customUserId,e.disableAutoHit||o.hit()},o.hit=function(){var e=encodeURIComponent(i.URL),t=encodeURIComponent(i.referrer);l("/tracker/hit",["url="+e,"ref="+t,"sw="+a.screen.width,"sh="+a.screen.height,"rnd="+Math.random()])},o.event=function(e){!function(){if(!d.isInitialized)throw new ReferenceError("iapSDK: SDK not initialized")}();var t={ADD_TO_CART:1,CONFIRM_ATTRIBUTION:2};if(!t[e.event])throw new TypeError("iapSDK: Unknown event type "+e.event);e.data||(e.data={}),e.event=t[e.event],l("/tracker/event",[],{event:e.event,data:e.data})},o.order=function(e){if(!e)throw new ReferenceError("iapSDK: order object undefined");l("/tracker/order",[],e)},o.conversion=function(e){if(!e)throw new ReferenceError("iapSDK: conversion object undefined");var t;"lead"===e.type&&(t={},e.category&&(t.category=e.category),e.brand&&(t.brand=e.brand),e.clickId&&(t.clickId=e.clickId),e={id:e.id+"",type:e.type,offerAlias:e.offerAlias,coupon:e.coupon,isNewCustomer:e.isNewCustomer,items:[t],comment:e.comment,productUserId:e.productUserId,goal:e.goal,data1:e.data1,data2:e.data2,data3:e.data3,data4:e.data4,data5:e.data5,data6:e.data6,data7:e.data7,data8:e.data8,data9:e.data9,data10:e.data10}),e.productUserId||delete e.productUserId,l("/tracker/conversion",[],e)},a.iapSDK&&n(a.iapSDK))for(var e=0;e<a.iapSDK.length;e++)o.push(a.iapSDK[e]);a.iapSDK=o}(window,document);